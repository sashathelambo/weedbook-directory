<!-- Start of Selection -->
<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Weedbook Vendor Directory</title>
    <link rel="shortcut icon" href="public/images/weedbook.png" type="image/x-icon" />
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #ebf0f2;
            color: #2d3748;
            text-align: center;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }
        
        header {
            background: linear-gradient(135deg, #3182ce, #2c5282);
            color: white;
            padding: 1rem 0;
            border-radius: 0.5rem;
            margin-bottom: 1.5rem;
        }
        
        .vendor-carousel,
        .product-list,
        main {
            background-color: white;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }
        
        select,
        button {
            padding: 0.5rem;
            border-radius: 0.25rem;
            border: 1px solid #cbd5e0;
        }
        
        button {
            background-color: #3182ce;
            color: white;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #2c5282;
        }
        
        #warning-message {
            background-color: #feebc8;
            border: 1px solid #fbd38d;
            color: #744210;
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
        }
        
        footer {
            background-color: #2c5282;
            color: white;
            padding: 1rem 0;
            text-align: center;
            position: relative;
            z-index: 1;
        }
        
        #age-modal {
            display: flex;
            align-items: center;
            justify-content: center;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
        }
        
        .modal-content {
            background: linear-gradient(135deg, #3182ce, #2c5282);
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            color: white;
            padding: 20px;
            width: 80%;
            max-width: 400px;
            transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
        }
        
        .modal-content h2 {
            color: #ebf8ff;
        }
        
        .modal-content p {
            color: #e2e8f0;
        }
        
        #vendor-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: linear-gradient(135deg, #3182ce, #2c5282);
            margin: 10% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            max-width: 400px;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            color: white;
            transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
        }
        
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }
        
        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
        
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: linear-gradient(135deg, #ebf0f2 25%, transparent 25%) -50px 0, linear-gradient(225deg, #ebf0f2 25%, transparent 25%) -50px 0, linear-gradient(315deg, #ebf0f2 25%, transparent 25%), linear-gradient(45deg, #ebf0f2 25%, transparent 25%);
            background-size: 100px 100px;
        }
        
        .carousel-container {
            position: relative;
            overflow: hidden;
            height: 3rem;
        }
        
        .carousel {
            display: flex;
            transition: transform 0.5s ease-in-out;
        }
        
        .vendor-name {
            flex: 0 0 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            font-weight: 600;
            color: #2c5282;
        }
        
        .dark-mode {
            background-color: #121212;
            color: #e0e0e0;
        }
        
        .dark-mode header {
            background: linear-gradient(135deg, #1e3a8a, #1a202c);
        }
        
        .dark-mode .vendor-carousel,
        .dark-mode .product-list,
        .dark-mode main {
            background-color: #1e293b;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }
        
        .dark-mode button {
            background-color: #3b82f6;
            color: #ffffff;
        }
        
        .dark-mode button:hover {
            background-color: #2563eb;
        }
        
        #dark-mode-toggle {
            background-color: #e2e8f0;
            color: #1a202c;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s;
        }
        
        #dark-mode-toggle:hover {
            background-color: #cbd5e0;
        }
        
        .dark-mode #dark-mode-toggle {
            background-color: #374151;
            color: #e0e0e0;
        }
        
        .dark-mode #dark-mode-toggle:hover {
            background-color: #4a5568;
        }
        
        #featured-vendor {
            background-color: #ebf8ff;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            transition: all 0.3s ease-in-out;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .dark-mode #featured-vendor {
            background-color: #2c5282;
        }
        
        #featured-vendor h2 {
            color: #2c5282;
            transition: color 0.3s ease-in-out;
        }
        
        .dark-mode #featured-vendor h2 {
            color: #ebf8ff;
        }
        
        #featured-vendor-name {
            color: #4a5568;
            transition: color 0.3s ease-in-out;
        }
        
        .dark-mode #featured-vendor-name {
            color: #e2e8f0;
        }
        
        #featured-vendor-link {
            transition: all 0.3s ease-in-out;
            padding: 0.75rem 2rem;
        }
        
        #featured-vendor-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(50, 50, 93, 0.11), 0 1px 3px rgba(0, 0, 0, 0.08);
        }
        
        @media (max-width: 640px) {
            #featured-vendor {
                padding: 1rem;
            }
            #featured-vendor h2 {
                font-size: 1.5rem;
            }
            #featured-vendor-name {
                font-size: 1.25rem;
            }
            #featured-vendor-link {
                font-size: 0.875rem;
                padding: 0.5rem 1rem;
            }
        }
        
        #age-modal .modal-content,
        #vendor-modal .modal-content {
            background: linear-gradient(135deg, #3182ce, #2c5282);
            transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
        }
        
        #age-modal .modal-content:hover,
        #vendor-modal .modal-content:hover {
            transform: scale(1.02);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.2);
        }
        
        #age-modal .modal-content button,
        #vendor-modal .modal-content button {
            transition: background-color 0.3s ease-in-out, transform 0.3s ease-in-out;
        }
        
        #age-modal .modal-content button:hover,
        #vendor-modal .modal-content button:hover {
            background-color: #2563eb;
            transform: translateY(-2px);
        }
        /* Add edge casings */
        
        .edge-casing {
            border: 2px solid #2c5282;
            /* Change color and width as needed */
            border-radius: 0.5rem;
            /* Optional: to match existing border-radius */
        }
        /* Example: Apply edge casing to specific sections */
        
        .vendor-carousel,
        .product-list,
        #featured-vendor {
            border: 2px solid #2c5282;
            /* Add edge casing */
        }
        /* Optional: Add edge casing to modals */
        
        #age-modal .modal-content,
        #vendor-modal .modal-content {
            border: 2px solid #2c5282;
            /* Add edge casing */
        }
        /* ... existing styles ... */
        
        .modal-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            /* Center items horizontally */
            justify-content: center;
            /* Center items vertically */
            position: relative;
        }
        
        .close {
            position: absolute;
            /* Position the close button absolutely */
            top: 10px;
            /* Adjust top position */
            right: 10px;
            /* Adjust right position */
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
        }
        /* ... existing styles ... */
    </style>
</head>

<body class="flex flex-col min-h-screen">
    <header>
        <div class="container mx-auto flex items-center justify-between">
            <h1 class="text-2xl font-bold">Weedbook Vendor Directory</h1>
            <nav>
                <div class="flex space-x-4">
                    <div class="flex justify-center items-center space-x-4">
                        <a href="#" class="hover:text-gray-300">Home</a>
                        <a href="vendor.html" class="hover:text-gray-300">Vendors</a>
                        <button id="dark-mode-toggle" class="bg-gray-200 dark:bg-gray-800 px-2 py-1 rounded">ðŸŒ“</button>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <main class="container mx-auto flex-grow py-8">
        <div class="h-16"></div>

        <div id="featured-vendor" class="mb-8 p-6 text-center max-w-2xl mx-auto">
            <h2 class="text-2xl font-bold mb-4">Featured Vendor of the Day</h2>
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                <p id="featured-vendor-name" class="text-xl font-semibold mb-2"></p>
                <a id="featured-vendor-link" href="#" class="inline-block bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded transition duration-300 ease-in-out">
                Visit Website
            </a>
                <div id="featured-vendor-coupons" class="mt-4"></div>
            </div>
        </div>

        <section class="vendor-carousel mb-8 p-6" id="vendor-carousel">
            <h2 class="text-xl font-bold mb-4">Featured Vendors</h2>
            <div class="carousel-container relative h-12 overflow-hidden">
                <div class="carousel flex transition-transform duration-500 ease-in-out" id="carousel">
                    <!-- Vendor names will be dynamically added here -->
                </div>
            </div>
        </section>

        <section class="product-list p-6" id="product-list">
            <h2 class="text-xl font-bold mb-6">Find a plug:</h2>
            <input type="text" id="vendor-search" placeholder="Search for a vendor..." class="w-full mb-4 p-2 border rounded" required pattern="[A-Za-z0-9\s]+" title="Only alphanumeric characters and spaces are allowed">
            <form class="mb-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <div>
                    <label for="category-select" class="block mb-2">Select Category</label>
                    <select id="category-select" class="w-full">
                        <option value="all">All Categories</option>
                        <option value="apple-pay">Apple Pay</option> <!-- Added option for Apple Pay -->
                    </select>
                </div>
                <div>
                    <label for="vendor-select" class="block mb-2">Select Vendor</label>
                    <select id="vendor-select" class="w-full">
                        <option value="all">All Vendors</option>
                    </select>
                </div>
                <div>
                    <label for="sort" class="block mb-2">Sort By</label>
                    <select id="sort" class="w-full">
                        <option value="price">Price</option>
                        <option value="rating">Rating</option>
                        <option value="category">Category</option>
                    </select>
                </div>
            </form>

            <div id="warning-message" class="hidden">
                <p><strong>Warning:</strong> Many vape and extract products on hemp vendor websites may have mislabeling or misleading descriptions. Always read product details and COAs carefully before purchasing. If unsure, contact the vendor directly
                    or seek guidance in the community. Stay informed to make safe choices.</p>
                <button id="warning-ok" class="mt-4 w-full">OK</button>
            </div>

            <div class="products grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" id="products">
                <!-- Product items will be dynamically loaded here -->
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2024 Weedbook Vendor Directory</p>
    </footer>

    <!-- Modals -->
    <div id="vendor-modal" class="fixed inset-0 bg-black bg-opacity-50 items-center justify-center hidden">
        <div class="modal-content p-6 rounded-lg max-w-md w-full">
            <span class="close" id="close-vendor-modal">&times;</span>
            <h3 class="text-xl font-bold mb-4">Vendor Link</h3>
            <a id="modal-vendor-link" href="#" class="text-blue-500 hover:underline">Visit Website</a>
        </div>
    </div>
    <div id="age-modal" class="fixed inset-0 bg-gradient-to-r from-purple-500 via-pink-500 to-red-500 flex items-center justify-center z-50">
        <div class="modal-content p-6 rounded-lg max-w-md w-full bg-gradient-to-r from-purple-500 via-pink-500 to-red-500 shadow-lg transform transition-all duration-300 scale-100 hover:scale-105">
            <h2 class="text-2xl font-bold mb-4 text-white">Age Verification</h2>
            <p class="mb-4 text-white">You must be at least 21 years old to enter this site. Are you of legal age?</p>
            <div class="flex justify-end space-x-4">
                <button id="age-no" class="bg-gradient-to-r from-red-400 to-red-600 text-white font-bold py-2 px-4 rounded transform transition-all duration-300 hover:scale-110 hover:from-red-600 hover:to-red-800" onclick="handleAgeVerification(false)">No</button>
                <button id="age-yes" class="bg-gradient-to-r from-green-400 to-green-600 text-white font-bold py-2 px-4 rounded transform transition-all duration-300 hover:scale-110 hover:from-green-600 hover:to-green-800" onclick="handleAgeVerification(true)">Yes</button>
            </div>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const elements = {
                vendorSelect: document.getElementById('vendor-select'),
                categorySelect: document.getElementById('category-select'),
                vendorModal: document.getElementById('vendor-modal'),
                closeVendorModalButton: document.getElementById('close-vendor-modal'),
                modalVendorLink: document.getElementById('modal-vendor-link'),
                warningMessage: document.getElementById('warning-message'),
                warningOkButton: document.getElementById('warning-ok'),
                ageModal: document.getElementById('age-modal'),
                ageYesButton: document.getElementById('age-yes'),
                ageNoButton: document.getElementById('age-no'),
                dashboard: document.querySelector('main'),
                vendorSearch: document.getElementById('vendor-search'),
                featuredVendorName: document.getElementById('featured-vendor-name'),
                featuredVendorLink: document.getElementById('featured-vendor-link'),
                featuredVendorCoupons: document.getElementById('featured-vendor-coupons'),
                carousel: document.getElementById('carousel'),
                darkModeToggle: document.getElementById('dark-mode-toggle')
            };

            let vendorData = [];

            fetch('VendorData.csv')
                .then(response => response.text())
                .then(data => {
                    const rows = data.split('\n');
                    rows.forEach((row, index) => {
                        if (index === 0) return;
                        const columns = row.split(',');
                        if (columns.length > 1) {
                            const vendor = {
                                name: columns[0],
                                link: columns[1],
                                coupons: columns[2] ? columns[2].split(', ') : [],
                                category: columns[3],
                                paymentMethods: columns[4] ? columns[4].split(', ') : []
                            };
                            vendorData.push(vendor);
                        }
                    });
                    vendorData.sort((a, b) => a.name.localeCompare(b.name));
                    populateVendorDropdown();
                    populateCategoryDropdown();
                    setFeaturedVendor();
                    initializeCarousel();
                })
                .catch(error => console.error('Error fetching vendor data:', error));

            function populateVendorDropdown() {
                const vendors = vendorData.map(vendor => vendor.name);
                const sortedVendors = vendors.sort();
                elements.vendorSelect.innerHTML = '<option value="all">All Vendors</option>';
                const fragment = document.createDocumentFragment();
                sortedVendors.forEach(vendor => {
                    const option = document.createElement('option');
                    option.value = vendor;
                    option.textContent = vendor;
                    fragment.appendChild(option);
                });
                elements.vendorSelect.appendChild(fragment);
            }

            function populateCategoryDropdown() {
                fetch('vendorcategory.csv')
                    .then(response => response.text())
                    .then(data => {
                        const rows = data.split('\n');
                        const categories = new Set();
                        rows.forEach((row, index) => {
                            if (index === 0) return;
                            const columns = row.split(',');
                            if (columns.length > 1) {
                                categories.add(columns[1].trim());
                            }
                        });
                        elements.categorySelect.innerHTML = '<option value="all">All Categories</option>';
                        const fragment = document.createDocumentFragment();
                        categories.forEach(category => {
                            const option = document.createElement('option');
                            option.value = category.toLowerCase();
                            option.textContent = category.charAt(0).toUpperCase() + category.slice(1);
                            fragment.appendChild(option);
                        });
                        elements.categorySelect.appendChild(fragment);
                    })
                    .catch(error => console.error('Error fetching category data:', error));
            }

            function filterProducts() {
                const selectedCategory = elements.categorySelect.value;
                const selectedVendor = elements.vendorSelect.value;
                const searchQuery = elements.vendorSearch.value.toLowerCase();

                const filteredProducts = vendorData.filter(vendor => {
                    const matchesCategory = selectedCategory === 'all' || vendor.category.toLowerCase() === selectedCategory;
                    const matchesVendor = selectedVendor === 'all' || vendor.name === selectedVendor;
                    const matchesSearch = vendor.name.toLowerCase().includes(searchQuery);
                    return matchesCategory && matchesVendor && matchesSearch;
                });

                displayFilteredVendors(filteredProducts);
            }

            function displayFilteredVendors(vendors) {
                const fragment = document.createDocumentFragment();
                vendors.forEach(vendor => {
                    const vendorElement = document.createElement('div');
                    vendorElement.classList.add('vendor');
                    vendorElement.innerHTML = `
                        <div class="flex items-center justify-center">
                            <a href="${vendor.link}" target="_blank" class="text-black-500 hover:underline">${vendor.name}</a>
                        </div>
                        <div class="coupons">
                            ${vendor.coupons.length > 0 ? 'Coupons: ' + vendor.coupons.join(', ') : 'No coupons available'}
                        </div>
                    `;
                    fragment.appendChild(vendorElement);
                });
                elements.vendorModal.innerHTML = '';
                elements.vendorModal.appendChild(fragment);
            }

            function setFeaturedVendor() {
                const randomVendor = vendorData[Math.floor(Math.random() * vendorData.length)];
                elements.featuredVendorName.textContent = randomVendor.name;
                elements.featuredVendorLink.href = randomVendor.link;
                elements.featuredVendorCoupons.innerHTML = randomVendor.coupons.length > 0 ?
                    `<h4 class="text-lg font-bold mb-2">Available Coupons:</h4>${randomVendor.coupons.join(', ')}` :
                    '<p>No coupons available.</p>';
            }

            function initializeCarousel() {
                const featuredVendors = vendorData;
                elements.carousel.innerHTML = '';

                featuredVendors.forEach(vendor => {
                    const vendorElement = document.createElement('div');
                    vendorElement.classList.add('vendor-name');
                    vendorElement.textContent = vendor.name;
                    elements.carousel.appendChild(vendorElement);
                });

                const firstVendorClone = elements.carousel.firstElementChild.cloneNode(true);
                elements.carousel.appendChild(firstVendorClone);

                let currentIndex = 0;
                const totalVendors = featuredVendors.length;

                function rotateCarousel() {
                    currentIndex++;
                    elements.carousel.style.transition = 'transform 0.5s ease-in-out';
                    elements.carousel.style.transform = `translateX(-${currentIndex * 100}%)`;

                    if (currentIndex === totalVendors) {
                        setTimeout(() => {
                            elements.carousel.style.transition = 'none';
                            elements.carousel.style.transform = 'translateX(0)';
                            currentIndex = 0;
                        }, 500);
                    }
                }

                setInterval(rotateCarousel, 3000);
            }

            function openVendorModal(vendor) {
                elements.modalVendorLink.href = vendor.link;
                elements.modalVendorLink.textContent = vendor.name;
                elements.vendorModal.style.display = 'flex';
                elements.vendorModal.style.justifyContent = 'center';
                elements.vendorModal.style.alignItems = 'center';
                elements.vendorModal.style.flexDirection = 'column';
                elements.vendorModal.style.textAlign = 'center';

                // Clear existing coupon list
                const existingCouponList = elements.vendorModal.querySelector('.coupon-list');
                if (existingCouponList) {
                    existingCouponList.remove();
                }

                const couponList = document.createElement('ul');
                couponList.classList.add('coupon-list');

                if (vendor.coupons.length > 0) {
                    const couponHeader = document.createElement('h4');
                    couponHeader.textContent = 'Coupon codes';
                    couponList.appendChild(couponHeader);

                    vendor.coupons.forEach(coupon => {
                        const listItem = document.createElement('li');
                        listItem.textContent = coupon;
                        couponList.appendChild(listItem);
                    });
                } else {
                    const noCoupons = document.createElement('p');
                    noCoupons.textContent = 'No coupons available.';
                    couponList.appendChild(noCoupons);
                }

                elements.modalVendorLink.insertAdjacentElement('afterend', couponList);
            }

            function closeVendorModal() {
                elements.vendorModal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }

            function showAgeVerificationModal() {
                const ageVerified = localStorage.getItem('ageVerified');
                if (ageVerified !== 'true') {
                    elements.ageModal.style.display = 'flex';
                } else {
                    elements.dashboard.style.display = 'block';
                    elements.warningMessage.style.display = 'block';
                    if (elements.warningOkButton) {
                        elements.warningOkButton.addEventListener('click', () => {
                            elements.warningMessage.style.display = 'none';
                        });
                    }
                }
            }

            function hideAgeVerificationModal() {
                if (elements.ageModal) {
                    elements.ageModal.style.display = 'none';
                }
            }

            window.handleAgeVerification = function(isOfAge) {
                hideAgeVerificationModal();
                if (isOfAge) {
                    localStorage.setItem('ageVerified', 'true');
                    elements.dashboard.style.display = 'block';
                    elements.warningMessage.style.display = 'block';
                    if (elements.warningOkButton) {
                        elements.warningOkButton.addEventListener('click', () => {
                            elements.warningMessage.style.display = 'none';
                        });
                    }
                } else {
                    window.location.href = 'https://www.google.com';
                }
            };

            function toggleDarkMode() {
                document.body.classList.toggle('dark-mode');
                localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
            }

            function loadDarkModePreference() {
                const darkMode = localStorage.getItem('darkMode') === 'true';
                if (darkMode) {
                    document.body.classList.add('dark-mode');
                }
            }

            // Event Listeners
            if (elements.ageYesButton) {
                elements.ageYesButton.addEventListener('click', () => handleAgeVerification(true));
            }
            if (elements.ageNoButton) {
                elements.ageNoButton.addEventListener('click', () => handleAgeVerification(false));
            }
            if (elements.vendorSelect) {
                elements.vendorSelect.addEventListener('change', (e) => {
                    const selectedVendor = vendorData.find(vendor => vendor.name === e.target.value);
                    if (selectedVendor) {
                        openVendorModal(selectedVendor);
                    } else {
                        closeVendorModal();
                    }
                });
            }
            elements.categorySelect.addEventListener('change', filterProducts);
            elements.vendorSearch.addEventListener('input', filterProducts);
            elements.closeVendorModalButton.addEventListener('click', closeVendorModal);
            elements.darkModeToggle.addEventListener('click', toggleDarkMode);

            showAgeVerificationModal();
            loadDarkModePreference();
            if (elements.vendorModal) {
                elements.vendorModal.style.display = 'none';
            }
        });
    </script>
</body>

</html>